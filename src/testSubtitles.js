import { generateSubtitles } from './subtitleGenerator.js';
import fs from 'fs';
import path from 'path';
import { fileURLToPath } from 'url';

const __dirname = path.dirname(fileURLToPath(import.meta.url));

async function testSubtitles() {
    try {
        console.log('Testing subtitle generation...');
        
        // Create a test story file
        const testStoryContent = `ุงูุนููุงู: ุฑุญูุฉ ุงูุญููุฉ

ุงููุตุฉ:
ูุงู ููุงู ุฑุฌู ุนุฌูุฒ ูุนูุด ูู ูุฑูุฉ ุตุบูุฑุฉ ูู ุฌุจุงู ุงูุฃุทูุณ. ูุงู ูุฐุง ุงูุฑุฌู ูุนุฑููุงู ุจุญููุชู ูุฐูุงุฆูุ ููุงู ุงููุงุณ ูุฃุชูู ุฅููู ูู ูู ููุงู ููุณุชุดูุฑูู ูู ุฃููุฑ ุญูุงุชูู. ูุงู ุงูุฑุฌู ุงูุนุฌูุฒ ูุฌูุณ ูู ููู ุชุญุช ุดุฌุฑุฉ ุงูุฒูุชูู ุงููุจูุฑุฉ ุฃูุงู ุจูุชูุ ููุณุชูุจู ุงูุฒูุงุฑ ุจุงุจุชุณุงูุฉ ูุงุฏุฆุฉ.

ูู ุฃุญุฏ ุงูุฃูุงูุ ุฌุงุก ุฅููู ุดุงุจ ุบุฑูุจ ููุงู ูู: "ุฃููุง ุงูุญูููุ ููุฏ ุณูุนุช ุนู ุญููุชู ูู ุจุนูุฏุ ูุฃุฑูุฏ ุฃู ุฃุณุฃูู ุณุคุงูุงู ูููุงู." ูุธุฑ ุงูุฑุฌู ุงูุนุฌูุฒ ุฅูู ุงูุดุงุจ ููุงู: "ุชุญุฏุซ ูุง ุจููุ ุฃูุง ููุง ููุณุงุนุฏุชู." ูุงู ุงูุดุงุจ: "ูุง ูู ุณุฑ ุงูุณุนุงุฏุฉ ุงูุญููููุฉุ"

ููุฑ ุงูุฑุฌู ุงูุนุฌูุฒ ููููุงู ุซู ูุงู: "ุงูุณุนุงุฏุฉ ุงูุญููููุฉ ูุง ุจูู ููุณุช ูู ุฌูุน ุงููุงู ุฃู ุงูุณูุทุฉุ ุจู ูู ุซูุงุซุฉ ุฃุดูุงุก: ุฃููุงูุ ุฃู ุชุญุจ ูุง ุชูุนูู. ุซุงููุงูุ ุฃู ุชุญุจ ูู ุญููู. ุซุงูุซุงูุ ุฃู ุชููู ููุชูุงู ููุง ูุฏูู." ุงุณุชูุน ุงูุดุงุจ ุจุงูุชูุงู ููุงู: "ูุฐุง ุฌูููุ ููู ููู ูููููู ุชุทุจูู ูุฐู ุงููุตุงุฆุญุ"

ุฃุฌุงุจ ุงูุฑุฌู ุงูุนุฌูุฒ: "ุงุจุฏุฃ ุจุงูุฎุทูุฉ ุงูุฃููู. ุงุจุญุซ ุนู ุดูุก ุชุญุจ ูุนูู ุญูุงูุ ูุงุนูู ุนููู ูู ููู. ุซู ุงุจุฏุฃ ูู ุฅุธูุงุฑ ุงูุญุจ ูุงูุงูุชูุงู ููู ุญูููุ ูุณุชุฌุฏ ุฃู ุงูุญุจ ูุนูุฏ ุฅููู ูุถุงุนูุงู. ูุฃุฎูุฑุงูุ ูู ููู ูุจู ุงููููุ ููุฑ ูู ุซูุงุซุฉ ุฃุดูุงุก ุฃูุช ููุชู ููุง."

ุดูุฑ ุงูุดุงุจ ุงูุฑุฌู ุงูุนุฌูุฒ ูุฐูุจ. ุจุนุฏ ุณููุงุชุ ุนุงุฏ ุงูุดุงุจ ุฅูู ุงููุฑูุฉ ููุฏ ุฃุตุจุญ ุฑุฌูุงู ูุงุฌุญุงู ูุณุนูุฏุงู. ูุงู ููุฑุฌู ุงูุนุฌูุฒ: "ููุฏ ุงุชุจุนุช ูุตุงุฆุญูุ ูุงูุขู ุฃูุง ุณุนูุฏ ุญูุงู. ุดูุฑุงู ูู ุนูู ุงูุญููุฉ ุงูุชู ุนููุชูู ุฅูุงูุง."

ุงุจุชุณู ุงูุฑุฌู ุงูุนุฌูุฒ ููุงู: "ุงูุญููุฉ ุงูุญููููุฉ ูุง ุจูู ูู ุฃู ุชุดุงุฑู ูุง ุชุนููุชู ูุน ุงูุขุฎุฑูู. ุงูุขู ุฏูุฑู ูุชุตุจุญ ุญูููุงู ูุชุณุงุนุฏ ูู ุญููู." ููู ุงูุดุงุจ ุงูุฏุฑุณุ ูุฃุตุจุญ ูู ุฃูุถุงู ูุตุฏุฑ ุญููุฉ ููุขุฎุฑูู.

ูููุฐ ุฐูู ุงููููุ ุชุนูู ุงููุงุณ ูู ุงููุฑูุฉ ุฃู ุงูุณุนุงุฏุฉ ุงูุญููููุฉ ุชููู ูู ุงูุนุทุงุก ูุงููุดุงุฑูุฉุ ูุฃู ุงูุญููุฉ ุชุฒุฏุงุฏ ุนูุฏูุง ูุดุงุฑููุง ูุน ุงูุขุฎุฑูู.`;

        const testStoryPath = path.join(__dirname, '../output/stories', 'test-story.txt');
        fs.writeFileSync(testStoryPath, testStoryContent, 'utf8');
        
        // Generate subtitles
        const subtitlePath = await generateSubtitles(testStoryPath, 420); // 7 minutes
        
        console.log('โ Subtitle generation test completed successfully!');
        console.log(`๐ Subtitle file created: ${subtitlePath}`);
        
        // Read and display the generated subtitles
        const subtitleContent = fs.readFileSync(subtitlePath, 'utf8');
        console.log('\n๐ Generated subtitles preview:');
        console.log(subtitleContent.substring(0, 500) + '...');
        
    } catch (error) {
        console.error('โ Error in subtitle test:', error);
    }
}

testSubtitles(); 